<?php

/**
 * Implements hook_codesign_info().
 */
function codesign_gnupg_codesign_info() {
  $signers = array();

  $signers['gnupg'] = array(
    'title' => t('GnuPG'),
    'sign callback' => 'codesign_gnupg_sign',
    'verify callback' => 'codesign_gnupg_verify',
    'status callback' => 'codesign_gnupg_status',
    'public keychain callback' => 'codesign_gnupg_get_verification_keys',
    'private keychain callback'  => 'codesign_gnupg_get_private_keys',
    'file' => backdrop_get_path('module', 'codesign_gnupg') . '/gnupg.codesign.inc',
  );

  return $signers;
}

/**
 * Implements hook_menu().
 */
function codesign_gnupg_menu() {
  $items = array();

  $items['admin/config/system/codesign/gnupg'] = array(
    'title' => 'GnuPG',
    'page callback' => 'backdrop_get_form',
    'page arguments' => array('codesign_gnupg_admin_form'),
    'access arguments' => array('administer site configuration'),
    'type' => MENU_LOCAL_TASK,
    'file' => 'codesign_gnupg.admin.inc',
  );
  $items['admin/config/system/codesign/gnupg/settings'] = array(
    'title' => 'Settings',
    'weight' => -10,
    'type' => MENU_DEFAULT_LOCAL_TASK,
  );
  $items['admin/config/system/codesign/gnupg/import-key'] = array(
    'title' => 'Import Key',
    'page callback' => 'backdrop_get_form',
    'page arguments' => array('codesign_gnupg_admin_import_key_form'),
    'access arguments' => array('administer site configuration'),
    'type' => MENU_LOCAL_TASK,
    'file' => 'codesign_gnupg.admin.inc',
  );

  return $items;
}
